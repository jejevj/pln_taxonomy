{% extends "layouts-admin.html" %} {% load static %} {% block title %}Manajemen Bidang{% endblock title %} {% block csstambah %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.3.0/css/responsive.bootstrap.min.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.bootstrap5.min.css" />
{% endblock csstambah %} {% block content %}
<!-- Start::app-content -->
<div class="main-content app-content">
  <div class="container-fluid">
    <!-- Page Header -->
    <div class="d-md-flex d-block align-items-center justify-content-between my-4 page-header-breadcrumb">
      
    </div>
    <!-- End Page Header -->
    <!-- Start:: row-2 -->
    <div class="row">
      <div class="col-xl-12">
        <div class="card custom-card">
          <div class="card-header">
            <div class="card-title">Daftar Bidang</div>
          </div>
          <div class="card-header">
            <div class="card-title">
              <a class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#tambahBidangModal">+ Tambah Bidang</a>
            </div>
          </div>
          <div class="card-body">
            <table id="responsiveDataTable" class="table table-bordered text-nowrap w-100">
              <thead>
                <tr>
                  <th>No</th>
                  <th>Nama Bidang</th>
                  <th>Aksi</th>
                </tr>
              </thead>
              <tbody>
                {% for bidang in bidang_list %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ bidang.nama_bidang }}</td>
                  <td>
                    <a class="btn btn-warning btn-edit" data-bs-toggle="modal" data-bs-target="#editBidangModal" data-bidang-id="{{ bidang.id_bidang }}" data-nama-bidang="{{ bidang.nama_bidang }}">
                      <i class="bi bi-pencil"></i>
                    </a>

                    <a class="btn btn-danger btn-hapus" data-bs-toggle="modal" data-bs-target="#hapusBidangModal" data-bidang-id="{{ bidang.id_bidang }}">
                      <i class="bi bi-trash"></i>
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- End:: row-2 -->
  </div>
</div>
<!-- End::app-content -->

<!-- Tambah Bidang Modal -->
<div class="modal fade" id="tambahBidangModal" tabindex="-1" aria-labelledby="tambahBidangModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="tambahBidangModalLabel">Tambah Bidang</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Form tambah bidang -->
        <form method="post" action="{% url 'tambah_bidang' %}">
          {% csrf_token %}
          <div class="mb-3">
            <label for="namaBidang" class="form-label">Nama Bidang:</label>
            <input type="text" class="form-control" id="namaBidang" name="nama_bidang" required />
          </div>
          <button type="submit" class="btn btn-primary">Simpan</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Edit Bidang Modal -->
<div class="modal fade" id="editBidangModal" tabindex="-1" aria-labelledby="editBidangModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editBidangModalLabel">Edit Bidang</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Form edit bidang -->
        <form method="post" id="editBidangForm" action="{% url 'edit_bidang' %}">
          {% csrf_token %}
          <input type="hidden" name="bidang_id" id="bidangId" />
          <div class="mb-3">
            <label for="editNamaBidang" class="form-label">Nama Bidang:</label>
            <input type="text" class="form-control" id="editNamaBidang" name="nama_bidang" required />
          </div>
          <button type="submit" class="btn btn-primary">Simpan</button>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- Hapus Bidang Modal -->
<div class="modal fade" id="hapusBidangModal" tabindex="-1" aria-labelledby="hapusBidangModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="hapusBidangModalLabel">Hapus Bidang</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Anda yakin ingin menghapus bidang ini?</p>
        <form method="post" id="hapusBidangForm" action="{% url 'hapus_bidang' %}">
          {% csrf_token %}
          <input type="hidden" name="bidang_id" id="hapusBidangId" />
          <button type="submit" class="btn btn-danger">Hapus</button>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock content %} {% block jstambah %}

<!-- Datatables Cdn -->
<script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.6/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<!-- Internal Datatables JS -->
<script src="{% static 'js/datatables.js' %}"></script>
<!-- Script untuk menangani klik tombol edit -->
<script>
  $(document).ready(function () {
    $("#responsiveDataTable").on("click", ".btn-edit", function () {
      var bidangId = $(this).data("bidang-id");
      var namaBidang = $(this).data("nama-bidang");

      // Mengisi nilai pada form edit
      $("#bidangId").val(bidangId);
      $("#editNamaBidang").val(namaBidang);

      // Menampilkan modal edit
      $("#editBidangModal").modal("show");
    });
  });
  $(document).ready(function () {
    $('#responsiveDataTable').on('click', '.btn-hapus', function () {
        var bidangId = $(this).data('bidang-id');

        // Mengisi nilai pada form hapus
        $('#hapusBidangId').val(bidangId);

        // Menampilkan modal hapus
        $('#hapusBidangModal').modal('show');
    });
});
</script>
{% endblock jstambah %}
